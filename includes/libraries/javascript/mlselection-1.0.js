function regionInit(a,b,d,c){$("#"+a+" > select").change(function(){regionChange(this,b,d,c)});$("#"+a+" > input:button[class='edit_region']").click(regionEdit)}function regionChange(d,e,k,h){$(d).nextAll("select").remove();var j=$(d).siblings("select").andSelf();var c=0;var a=new Array();var g=new Array();for(i=0;i<j.length;i++){sel=j[i];if(sel.value>0){c=sel.value;a.push(c);name=sel.options[sel.selectedIndex].text;g.push(name)}}$(d).siblings(".mls_id").val(c);$(d).siblings(".mls_ids").val(a.join(","));$(d).siblings(".mls_name").val(name);$(d).siblings(".mls_names").val(g.join("\t"));var l=true;if(e&&j.length>=parseInt(e)){l=false}if(d.value>0&&l){h=h?h:"region";var f=d;var b=SITE_URL+"/index.php?app=mlselection&type="+h;$.getJSON(b,{pid:d.value},function(m){if(m.done){if(m.retval.length>0){$("<select><option>"+lang.select_pls+"</option></select>").change(function(){regionChange(this,e,k,h)}).insertAfter(f);var m=m.retval;for(i=0;i<m.length;i++){$(f).next("select").append("<option value='"+m[i].region_id+"'>"+m[i].region_name+"</option>")}}}else{alert(m.msg)}})}if(k){k()}}function regionEdit(){$(this).siblings("select").show();$(this).siblings("span").andSelf().hide()}function gcategoryInit(a){$("#"+a+" > select").change(function(){gcategoryChange(this)});window.onerror=function(){return true};$("#"+a+" .edit_gcategory").click(gcategoryEdit)}function gcategoryChange(e){$(e).nextAll("select").remove();var c=$(e).siblings("select").andSelf();var f=0;var d=new Array();for(i=0;i<c.length;i++){sel=c[i];if(sel.value>0){f=sel.value;name=sel.options[sel.selectedIndex].text;d.push(name)}}$(e).siblings(".mls_id").val(f);$(e).siblings(".mls_name").val(name);$(e).siblings(".mls_names").val(d.join("\t"));if(e.value>0){var a=e;var b=SITE_URL+"/index.php?app=mlselection&type=gcategory";$.getJSON(b,{pid:e.value},function(g){if(g.done){if(g.retval.length>0){$("<select><option>"+lang.select_pls+"</option></select>").change(function(){gcategoryChange(this)}).insertAfter(a);var g=g.retval;for(i=0;i<g.length;i++){$(a).next("select").append("<option value='"+g[i].cate_id+"'>"+g[i].cate_name+"</option>")}}}else{alert(g.msg)}})}}function gcategoryEdit(){$(this).siblings("select").show();$(this).siblings("span").andSelf().remove()};
