__DIALOG_WRAPPER__={};DialogManager={create:function(b){var a={};if(!__DIALOG_WRAPPER__[b]){a=new Dialog(b);__DIALOG_WRAPPER__[b]=a}else{a=DialogManager.get(b)}return a},get:function(a){return __DIALOG_WRAPPER__[a]},close:function(a){if(__DIALOG_WRAPPER__[a].close()){__DIALOG_WRAPPER__[a]=null}},onClose:function(){return true},loadStyle:function(){var c=$("#dialog_js").attr("src");var a=c.split("/");var b=a.slice(0,a.length-1).join("/")+"/dialog.css";$("#dialog_js").after('<link href="'+b+'" rel="stylesheet" type="text/css" />')}};ScreenLocker={style:{position:"absolute",top:"0px",left:"0px",backgroundColor:"#000",opacity:0.5,zIndex:999},masker:null,lock:function(a){if(this.masker!==null){this.masker.width($(document).width()).height($(document).height());return true}this.masker=$("<div></div>");if($.browser.msie){$("select").css("visibility","hidden")}this.masker.css(this.style);if(a){this.masker.css("zIndex",a)}this.masker.width($(document).width()).height($(document).height());$(document.body).append(this.masker)},unlock:function(){if(this.masker===null){return true}this.masker.remove();this.masker=null;if($.browser.msie){$("select").css("visibility","visible")}}};Dialog=function(a){this.id=a;this.init()};Dialog.prototype={id:null,dom:null,lastPos:null,status:"complete",onClose:function(){return true},tmp:{},init:function(){this.dom={wrapper:null,body:null,head:null,title:null,close_button:null,content:null};this.dom.wrapper=$('<div id="dialog_object_'+this.id+'" class="dialog_wrapper"></div>').get(0);this.dom.body=$('<div class="dialog_body"></div>').get(0);this.dom.head=$('<h3 class="dialog_head"></h3>').get(0);this.dom.title=$('<span class="dialog_title_icon"></span>').get(0);this.dom.close_button=$('<span class="dialog_close_button">close</span>').get(0);this.dom.content=$('<div class="dialog_content"></div>').get(0);$(this.dom.head).append('<div class="dialog_ornament1"></div><div class="dialog_ornament2"></div>').append($('<span class="dialog_title"></span>').append(this.dom.title)).append(this.dom.close_button);$(this.dom.body).append(this.dom.head).append(this.dom.content);$(this.dom.wrapper).append(this.dom.body).append('<div style="clear:both;display:block;"></div>');$(this.dom.wrapper).css({zIndex:9999,display:"none",position:"absolute"});$(this.dom.body).css({position:"relative"});$(this.dom.head).css({cursor:"move"});$(this.dom.close_button).css({position:"absolute","text-indent":"-9999px",cursor:"pointer",overflow:"hidden"});$(this.dom.content).css({margin:"0px",padding:"0px"});var a=this;$(this.dom.close_button).click(function(){DialogManager.close(a.id)});$(this.dom.wrapper).draggable({handle:this.dom.body});$(document.body).append(this.dom.wrapper)},hide:function(){$(this.dom.wrapper).hide()},show:function(a){if(a){this.setPosition(a)}ScreenLocker.lock(999);$(this.dom.wrapper).show()},close:function(){if(!this.onClose()){return false}$(this.dom.wrapper).remove();ScreenLocker.unlock();return true},setTitle:function(a){$(this.dom.title).html(a)},setContents:function(b,a){contents=this.createContents(b,a);if(typeof(contents)=="string"){$(this.dom.content).html(contents)}else{$(this.dom.content).empty();$(this.dom.content).append(contents)}},setStyle:function(a){if(typeof(a)=="object"){$(this.dom.wrapper).css(a)}else{$(this.dom.wrapper).addClass(a)}},setWidth:function(a){this.setStyle({width:a+"px"})},setHeight:function(a){this.setStyle({height:a+"px"})},createContents:function(g,f){var e="",d=this,c="complete";if(!f){this.setStatus(c);return g}switch(g){case"ajax":$.get(f,function(i){d.setContents(i);d.setPosition(d.lastPos)});e=this.createContents("loading",{text:"loading..."});break;case"loading":e='<div class="dialog_loading"><div class="dialog_loading_text">'+f.text+"</div></div>";c="loading";break;case"message":var g="notice";if(f.type){g=f.type}_message_body=$('<div class="dialog_message_body"></div>');_message_contents=$('<div class="dialog_message_contents dialog_message_'+g+'">'+f.text+"</div>");_buttons_bar=$('<div class="dialog_buttons_bar"></div>');switch(g){case"notice":case"warning":var b=lang.confirm;if(f.button_name){b=f.button_name}_ok_button=$('<input type="button" class="btn1" value="'+b+'" />');$(_ok_button).click(function(){if(f.onclick){if(!f.onclick.call()){return}}DialogManager.close(d.id)});$(_buttons_bar).append(_ok_button);break;case"confirm":var a=lang.yes;var h=lang.no;if(f.yes_button_name){a=f.yes_button_name}if(f.no_button_name){h=f.no_button_name}_yes_button=$('<input type="button" class="btn1" value="'+a+'" />');_no_button=$('<input type="button" class="btn2" value="'+h+'" />');$(_yes_button).click(function(){if(f.onClickYes){if(f.onClickYes.call()===false){return}}DialogManager.close(d.id)});$(_no_button).click(function(){if(f.onClickNo){if(!f.onClickNo.call()){return}}DialogManager.close(d.id)});$(_buttons_bar).append(_yes_button).append(_no_button);break}e=$(_message_body).append(_message_contents).append(_buttons_bar);break}this.setStatus(c);return e},setPosition:function(f){this.lastPos=f;if(typeof(f)=="string"){switch(f){case"center":var d=0;var c=0;var b=$(this.dom.wrapper).width();var e=$(this.dom.wrapper).height();d=$(window).scrollLeft()+($(window).width()-b)/2;c=$(window).scrollTop()+($(window).height()-e)/2;$(this.dom.wrapper).css({left:d+"px",top:c+"px"});break}}else{var a={};if(typeof(f.left)!="undefined"){a.left=f.left}if(typeof(f.top)!="undefined"){a.top=f.top}$(this.dom.wrapper).css(a)}},setStatus:function(a){this.status=a},getStatus:function(){return this.status},disableClose:function(a){this.tmp.oldOnClose=this.onClose;this.onClose=function(){if(a){alert(a)}return false}},enableClose:function(){this.onClose=this.tmp.oldOnClose;this.tmp.oldOnClose=null}};DialogManager.loadStyle();
