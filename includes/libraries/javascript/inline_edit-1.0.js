$(function(){var d=window.location.search;var h=d.substr(1).split("&");var g="";var e="";var b="";for(var c=0;c<h.length;c++){var f=h[c];var a=f.split("=");if(a[0]=="app"){g=a[1]}if(a[0]=="sort"){e=a[1]}if(a[0]=="order"){b=a[1]}}$('span[ectype="order_by"]').each(function(){if($(this).attr("fieldname")==e){if(b=="asc"){$(this).removeClass();$(this).addClass("sort_asc")}else{if(b=="desc"){$(this).removeClass();$(this).addClass("sort_desc")}}}});$('span[ectype="inline_edit"]').click(function(){var m=$(this).text();var n=$(this).attr("fieldname");var j=$(this).attr("fieldid");var l=$(this).attr("required");var k=$(this).attr("datatype");var i=$(this).attr("maxvalue");$('<input type="text">').css({border:"1px solid #ccc",width:"80%",height:"20px"}).attr({value:m,size:5}).appendTo($(this).parent()).focus().select().keyup(function(o){if(o.keyCode==13){if(l){if(!required($(this).attr("value"),m,$(this))){return}}if(k){if(!check_type(k,$(this).attr("value"),m,$(this))){return}}if(i){if(!check_max($(this).attr("value"),m,i,$(this))){return}}$(this).prev("span").show().text($(this).attr("value"));$.get("index.php?app="+g+"&act=ajax_col&ajax=1",{id:j,column:n,value:$(this).attr("value")},function(p){if(p==="false"){alert(lang.name_exist);$('span[fieldname="'+n+'"][fieldid="'+j+'"]').text(m);return}});$(this).remove()}}).blur(function(){if(l){if(!required($(this).attr("value"),m,$(this))){return}}if(k){if(!check_type(k,$(this).attr("value"),m,$(this))){return}}if(i){if(!check_max($(this).attr("value"),m,i,$(this))){return}}$(this).prev("span").show().text($(this).attr("value"));$.get("index.php?app="+g+"&act=ajax_col&ajax=1",{id:j,column:n,value:$(this).attr("value")},function(o){if(o==="false"){alert(lang.name_exist);$('span[fieldname="'+n+'"][fieldid="'+j+'"]').text(m);return}});$(this).remove()});$(this).hide()});$('img[ectype="inline_edit"]').click(function(){var l=$(this).attr("fieldid");var k=$(this).attr("fieldname");var j=$(this).attr("src");var i=($(this).attr("fieldvalue"))==0?1:0;$.get("index.php?app="+g+"&act=ajax_col&ajax=1",{id:l,column:k,value:i},function(m){if(m==="true"){if(j.indexOf("positive")>-1){if(j.indexOf("disabled")>-1){$('img[fieldid="'+l+'"][fieldname="'+k+'"]').attr({src:j.replace("disabled","enabled"),fieldvalue:i})}else{$('img[fieldid="'+l+'"][fieldname="'+k+'"]').attr({src:j.replace("enabled","disabled"),fieldvalue:i})}}else{if(j.indexOf("negative")>-1){if(j.indexOf("enabled")>-1){$('img[fieldid="'+l+'"][fieldname="'+k+'"]').attr({src:j.replace("enabled","disabled"),fieldvalue:i})}else{$('img[fieldid="'+l+'"][fieldname="'+k+'"]').attr({src:j.replace("disabled","enabled"),fieldvalue:i})}}}}})});$('img[ectype="inline_edit"]').parent().attr("title",lang.editable);$('span[ectype="order_by"]').hover(function(){$(this).css({cursor:"pointer"})},function(){});$('span[ectype="order_by"]').click(function(){var n=$(this).attr("fieldname");var l=false;for(var k=0;k<h.length;k++){var m=h[k];var j=m.split("=");if("page"==j[0]){h[k]="page=1"}else{if("sort"==j[0]){h[k]="sort="+n;l=true}else{if("order"==j[0]){h[k]="order="+(j[1]=="asc"?"desc":"asc")}}}}if(!l){h.push("sort="+n);h.push("order=asc")}if(location.pathname.indexOf("/admin/")>-1){location.assign(SITE_URL+"/admin/index.php?"+h.join("&"));return}location.assign(SITE_URL+"/index.php?"+h.join("&"))})});function required(c,a,b){if(c==""){b.prev("span").show().text(a);b.remove();alert(lang.not_empty);return 0}return 1}function check_type(b,d,c,e){if(b=="number"){if(isNaN(d)){e.prev("span").show().text(c);e.remove();alert(lang.only_number);return 0}}if(b=="int"){var a=/^-{0,1}[0-9]{1,}$/;if(!a.test(d)){e.prev("span").show().text(c);e.remove();alert(lang.only_int);return 0}}if(b=="pint"){var a=/^[0-9]+$/;if(!a.test(d)){e.prev("span").show().text(c);e.remove();alert(lang.only_pint);return 0}}return 1}function check_max(d,b,a,c){if(parseInt(d)>parseInt(a)){c.prev("span").show().text(b);c.remove();alert(lang.small+a);return 0}return 1};
